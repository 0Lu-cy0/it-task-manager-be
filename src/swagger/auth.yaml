paths:
  /auth/register:
    post:
      tags:
        - Authentication
      summary: Đăng ký tài khoản mới
      description: Tạo tài khoản người dùng mới với email và mật khẩu
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - email
                - password
                - full_name
              properties:
                username:
                  type: string
                  minLength: 3
                  maxLength: 20
                  example: "john_doe"
                email:
                  type: string
                  format: email
                  example: "john@example.com"
                password:
                  type: string
                  minLength: 6
                  example: "password123"
                full_name:
                  type: string
                  minLength: 2
                  maxLength: 50
                  example: "John Doe"
      responses:
        "201":
          description: Đăng ký thành công
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: "#/components/schemas/User"
                          accessToken:
                            type: string
                          refreshToken:
                            type: string
        "400":
          $ref: "#/components/responses/ValidationError"
        "409":
          description: Email hoặc username đã tồn tại
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          $ref: "#/components/responses/RateLimitError"

  /auth/login:
    post:
      tags:
        - Authentication
      summary: Đăng nhập
      description: Xác thực người dùng và trả về JWT tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: "john@example.com"
                password:
                  type: string
                  example: "password123"
      responses:
        "200":
          description: Đăng nhập thành công
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: "#/components/schemas/User"
                          accessToken:
                            type: string
                          refreshToken:
                            type: string
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          description: Email hoặc mật khẩu không đúng
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          $ref: "#/components/responses/RateLimitError"

  /auth/reset-password/request:
    post:
      tags:
        - Authentication
      summary: Yêu cầu reset mật khẩu
      description: Gửi email reset mật khẩu đến người dùng
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  example: "john@example.com"
      responses:
        "200":
          description: Email reset đã được gửi
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/ValidationError"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "429":
          $ref: "#/components/responses/RateLimitError"

  /auth/reset-password/confirm:
    post:
      tags:
        - Authentication
      summary: Xác nhận reset mật khẩu
      description: Đặt lại mật khẩu mới với token từ email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
                - newPassword
              properties:
                token:
                  type: string
                  example: "reset_token_here"
                newPassword:
                  type: string
                  minLength: 6
                  example: "newpassword123"
      responses:
        "200":
          description: Mật khẩu đã được đặt lại
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          description: Token không hợp lệ hoặc đã hết hạn
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          $ref: "#/components/responses/RateLimitError"

  /auth/me:
    get:
      tags:
        - Authentication
      summary: Lấy thông tin người dùng hiện tại
      description: Trả về thông tin chi tiết của người dùng đã đăng nhập
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Thông tin người dùng
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/User"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

    put:
      tags:
        - Authentication
      summary: Cập nhật thông tin cá nhân
      description: Cập nhật thông tin profile của người dùng
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  minLength: 3
                  maxLength: 20
                  example: "john_doe_updated"
                full_name:
                  type: string
                  minLength: 2
                  maxLength: 50
                  example: "John Doe Updated"
                avatar:
                  type: string
                  example: "https://example.com/new-avatar.jpg"
      responses:
        "200":
          description: Cập nhật thành công
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/User"
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "409":
          description: Username đã tồn tại
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/me/password:
    put:
      tags:
        - Authentication
      summary: Đổi mật khẩu
      description: Thay đổi mật khẩu của người dùng hiện tại
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - currentPassword
                - newPassword
              properties:
                currentPassword:
                  type: string
                  example: "oldpassword123"
                newPassword:
                  type: string
                  minLength: 6
                  example: "newpassword123"
      responses:
        "200":
          description: Đổi mật khẩu thành công
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          description: Mật khẩu hiện tại không đúng
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Làm mới access token
      description: Tạo access token mới từ refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  example: "refresh_token_here"
      responses:
        "200":
          description: Token mới được tạo thành công
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          accessToken:
                            type: string
                          refreshToken:
                            type: string
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          description: Refresh token không hợp lệ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          $ref: "#/components/responses/RateLimitError"

  /auth/logout:
    post:
      tags:
        - Authentication
      summary: Đăng xuất
      description: Vô hiệu hóa refresh token và đăng xuất người dùng
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Đăng xuất thành công
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
